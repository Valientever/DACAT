PhaseModel(
  (net): TemporalCNN(
    (cnn): CNN(
      (featureNet): ConvNeXtV2(
        (downsample_layers): ModuleList(
          (0): Sequential(
            (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
            (1): LayerNorm()
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
          )
          (2): Sequential(
            (0): LayerNorm()
            (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
          )
          (3): Sequential(
            (0): LayerNorm()
            (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
          )
        )
        (stages): ModuleList(
          (0): Sequential(
            (0): Block(
              (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=384, out_features=96, bias=True)
              (drop_path): Identity()
            )
            (1): Block(
              (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=384, out_features=96, bias=True)
              (drop_path): Identity()
            )
            (2): Block(
              (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=384, out_features=96, bias=True)
              (drop_path): Identity()
            )
          )
          (1): Sequential(
            (0): Block(
              (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=768, out_features=192, bias=True)
              (drop_path): Identity()
            )
            (1): Block(
              (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=768, out_features=192, bias=True)
              (drop_path): Identity()
            )
            (2): Block(
              (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=768, out_features=192, bias=True)
              (drop_path): Identity()
            )
          )
          (2): Sequential(
            (0): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (1): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (2): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (3): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (4): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (5): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (6): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (7): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
            (8): Block(
              (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
              (drop_path): Identity()
            )
          )
          (3): Sequential(
            (0): Block(
              (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
              (drop_path): Identity()
            )
            (1): Block(
              (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
              (drop_path): Identity()
            )
            (2): Block(
              (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
              (norm): LayerNorm()
              (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (grn): GRN()
              (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
              (drop_path): Identity()
            )
          )
        )
        (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (head): Identity()
      )
      (out_layer): Linear(in_features=768, out_features=7, bias=True)
    )
    (temporal_head): LSTMHead(
      (lstm): LSTM(768, 512, batch_first=True)
      (out_layer): Linear(in_features=512, out_features=7, bias=True)
    )
  )
  (criterion): CrossEntropyLoss()
)
Epoch   1: Train (loss 1.244, acc 0.538) Val (f1 0.695, ba 0.715, acc 0.738) Test (Frame scores: p 0.665, r 0.679, j 0.486, f1 0.646; Video scores: ba 0.687, acc 0.696) 
Epoch   2: Train (loss 0.629, acc 0.770) Val (f1 0.843, ba 0.826, acc 0.857) Test (Frame scores: p 0.777, r 0.753, j 0.603, f1 0.749; Video scores: ba 0.763, acc 0.802) 
Epoch   3: Train (loss 0.389, acc 0.871) Val (f1 0.841, ba 0.829, acc 0.920) Test (Frame scores: p 0.820, r 0.677, j 0.569, f1 0.694; Video scores: ba 0.692, acc 0.832) 
